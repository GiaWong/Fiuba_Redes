## **4.4 Generalized Forwarding and SDN**

Tradicionalmente, los routers hacían **destination-based forwarding**: miraban la dirección de destino del paquete y lo mandaban al próximo salto.
Con el tiempo, surgió la idea de **generalized forwarding**:
el reenvío ya no depende solo de la dirección de destino, sino de **varios campos del paquete**.

Esto se combina con **SDN (Software Defined Networking)**, donde:

* La lógica de control (qué hacer con los paquetes) se separa de los routers.
* Un **controlador central** decide las reglas, y los switches solo aplican esas reglas.
* El protocolo más usado para esto es **OpenFlow**.

 **Ejemplo** Antes los colectiveros miraban solo el barrio al que ibas (destino). Ahora también miran si sos estudiante, jubilado, si pagaste con SUBE, etc. Según eso, te pueden mandar por distintos caminos o aplicar reglas diferentes.

---

## **4.4.1 Match**

El **“match”** es la parte donde el switch/router mira el paquete y decide si coincide con alguna regla.

* Puede fijarse en muchos campos del encabezado:

  * Dirección IP origen/destino
  * Dirección MAC
  * Puerto TCP/UDP
  * Protocolo (TCP, UDP, ICMP)
  * VLAN, etc.

 **Ejemplo:** Es como un guardia de seguridad en la puerta de un boliche. Mira tu DNI, tu edad, tu vestimenta, si estás en la lista, etc. Dependiendo de qué coincida con las reglas, decide qué hacer con vos.

---

## **4.4.2 Action**

Una vez que el paquete hace “match” con una regla, se ejecuta una **acción**.

Acciones típicas en OpenFlow:

* **Forward:** mandar el paquete a un puerto específico.
* **Drop:** descartar el paquete (ejemplo: bloquear tráfico indeseado).
* **Modify:** cambiar un campo del encabezado (ejemplo: reescribir la dirección IP de origen).
* **Send to controller:** enviar el paquete al controlador SDN para que decida.

 **Ejemplo:** Siguiendo con el boliche:

* Si cumplís con la edad → entrás.
* Si estás borracho → te rebotan (drop).
* Si sos VIP → te pasan por otra puerta (modify).
* Si hay duda → llaman al encargado (controller).

---

## **4.4.3 OpenFlow Examples of Match-plus-action in Action**

OpenFlow implementa la lógica de **match + action** con **tablas de flujo (flow tables)**.
Cada entrada en la tabla tiene:

1. Un conjunto de campos para hacer **match**.
2. Una o varias **acciones** asociadas.

Ejemplos concretos:

* **Firewall SDN:**

  * Regla: si el paquete viene de `IP 10.0.0.5` y puerto `22 (SSH)` → **drop**.
* **Balanceo de carga:**

  * Regla: si el tráfico viene al puerto `80 (HTTP)` → reenviar alternadamente a diferentes servidores.
* **QoS (calidad de servicio):**

  * Regla: si es tráfico de voz (VoIP) → priorizar (forward con prioridad alta).
* **Redirección:**

  * Regla: si el tráfico HTTP va al puerto `80`, redirigir al puerto `8080`.

**Ejemploo**

* El controlador SDN es como el “jefe de seguridad” del boliche que le da una lista de reglas a los patovicas.
* Los patovicas (switches) solo aplican esas reglas: quién entra, quién sale, quién va a VIP y a quién llaman al jefe.

---

 **Entonces:**

* Con **generalized forwarding**, los routers/switches ya no miran solo la IP destino, sino cualquier campo del paquete.
* El proceso tiene dos pasos:

  1. **Match:** ver si el paquete coincide con una regla.
  2. **Action:** ejecutar lo que corresponda (reenviar, descartar, modificar, enviar al controlador).
* **OpenFlow** es el estándar de SDN que implementa este modelo con tablas de flujo.



#  Tabla Match + Action

| **Match (qué miro en el paquete)**        | **Action (qué hago con el paquete)** | **Ejemplo**                                                        |
| ----------------------------------------- | ------------------------------------ | ---------------------------------------------------------------------------- |
| IP destino = `192.168.1.10`               | Forward al puerto 3                  | “Si vas a Av. Corrientes 1234 → tomá la salida 3.”                           |
| IP origen = `10.0.0.5`, Puerto = 22 (SSH) | Drop (descartar)                     | “Si sos el vecino pesado del depto. 5 queriendo entrar por SSH → no pasa.”   |
| Protocolo = VoIP                          | Forward con prioridad alta           | “Si venís hablando por teléfono → pasá primero en la fila.”                  |
| Puerto destino = 80 (HTTP)                | Balancear entre puerto 2 y 4         | “Si venís a pedir comida → mandamos algunos al mozo 2 y otros al mozo 4.”    |
| VLAN = 100                                | Modificar destino → VLAN 200         | “Si venís con pulsera roja (VLAN 100), te la cambiamos por azul (VLAN 200).” |
| Cualquier otro caso                       | Enviar al controlador (SDN)          | “Si no sé qué hacer con vos → llamo al jefe (controlador).”                  |

---


1. El switch/router **mira campos del paquete** (IP, puerto, protocolo, VLAN, etc.).
2. Busca coincidencias en sus **tablas de flujo**.
3. Si encuentra una coincidencia (**match**) → ejecuta la acción (**action**).
4. Si no hay coincidencia → consulta al controlador SDN.

---
