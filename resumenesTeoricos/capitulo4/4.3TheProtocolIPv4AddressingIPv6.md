## **4.3 The Internet Protocol (IP): IPv4, Addressing, IPv6, and More**

El protocolo IP es el **corazón de la capa de red en Internet**. Define cómo se arma el paquete (llamado **datagrama**) y cómo viaja de un dispositivo a otro a través de routers.

Funciones principales:

1. **Definir el formato del datagrama (paquete IP).**
2. **Direccionamiento:** cómo identificar a cada dispositivo en la red.
3. **Fragmentación y reensamblado** (si el paquete es muy grande para un enlace).

 **Ejemplo:** Pensalo como un sobre de correo. Tiene que tener formato claro (dónde va la dirección, remitente, etc.) y una dirección única para que llegue a destino.

---

## **4.3.1 IPv4 Datagram Format**

Un **datagrama IPv4** es como el “sobre” que lleva los datos. Tiene dos partes:

* **Cabecera (header):** info de control.
* **Datos (payload):** lo que realmente queremos enviar (ejemplo: un segmento TCP).

Campos importantes del header (versión simplificada):

* **Version:** indica si es IPv4 o IPv6.
* **Header length:** tamaño del encabezado.
* **Type of Service (ToS):** prioridad del paquete.
* **Total length:** tamaño total del paquete.
* **Identification, Flags, Fragment offset:** usados si hay fragmentación.
* **Time to Live (TTL):** cuántos saltos puede dar antes de descartarse.
* **Protocol:** indica si los datos son TCP, UDP, ICMP, etc.
* **Header checksum:** para verificar que la cabecera no esté corrupta.
* **Source IP / Destination IP:** direcciones de origen y destino.

 **Ejemplo:** Imaginá un sobre de correo:

* “TTL” es como la fecha de vencimiento: si nadie lo entrega en cierto tiempo, se descarta.
* “Checksum” es como revisar que la dirección esté bien escrita.

---

## **4.3.2 IPv4 Addressing**

Cada dispositivo en la red tiene una **dirección IP única (32 bits en IPv4)**.

* **Formato:** se escribe en 4 números (0–255), por ejemplo: `192.168.0.1`.
* **Jerarquía:** la dirección se divide en dos partes:

  * **Prefijo de red (network ID):** indica la red a la que pertenece.
  * **Host ID:** identifica al dispositivo dentro de esa red.
* **Subredes:** permiten dividir una red en redes más chicas usando máscaras (ej: `/24`).

 **Ejemplo:** Es como un domicilio postal:

* La “red” es la calle (Av. Corrientes).
* El “host” es el número de la casa (1234).

---

## **4.3.3 Network Address Translation (NAT)**

El **NAT** se inventó porque el espacio de direcciones IPv4 se estaba agotando.

* Con NAT, **varias máquinas de una red privada (con IPs locales)** pueden compartir **una sola IP pública** para salir a Internet.
* El router guarda una **tabla de traducción** que asocia:
  `(IP privada, puerto privado)` → `(IP pública, puerto público)`
* Esto funciona porque en TCP/UDP cada conexión usa un puerto diferente.

 **Ejemplo:** Es como un edificio con un solo portero eléctrico (IP pública). Desde afuera, todos ven el mismo número. Pero adentro, el portero sabe a qué departamento (IP privada) corresponde cada timbre (puerto).

---

## **4.3.4 IPv6**

Como las direcciones IPv4 ya no alcanzaban, se creó **IPv6**, con **128 bits de dirección** (en vez de 32).

* Formato: 8 grupos de 4 dígitos hexadecimales (ejemplo: `2001:0db8:85a3:0000:0000:8a2e:0370:7334`).
* Ventajas:

  * Espacio enorme de direcciones.
  * Encabezado más simple que IPv4.
  * Soporte nativo para QoS (calidad de servicio).
  * No necesita NAT.

 **Ejemplo:** Es como pasar de tener matrículas de autos con 6 números (que se acaban) a placas con letras y números casi infinitas. Ahora todos pueden tener su patente única sin compartir.

---

 **En conclusion:**

* El **IP** define cómo se arman y mueven los paquetes.
* En **IPv4**, el datagrama tiene un encabezado con campos clave como TTL, direcciones y checksum.
* El **direccionamiento** permite identificar redes y hosts.
* El **NAT** solucionó la falta de IPs compartiendo una sola pública para muchos privados.
* **IPv6** vino a reemplazar IPv4 con direcciones gigantes y sin necesidad de NAT.



