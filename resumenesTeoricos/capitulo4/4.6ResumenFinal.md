
#  **Recuerda:**

```
Capa de Red
│
├── 4.1 Overview
│   ├── Forwarding (decisión inmediata: próximo salto)
│   ├── Routing (cálculo de rutas)
│   └── Planes:
│       ├── Data Plane → forwarding en cada router
│       └── Control Plane → decide las rutas
│
├── 4.2 Inside a Router
│   ├── Input ports → revisión dirección destino
│   ├── Switching fabric → conecta entrada con salida
│   ├── Output ports → colas + scheduling
│   └── Procesador → lógica de routing
│
├── 4.3 Internet Protocol (IP)
│   ├── IPv4 datagram format (TTL, checksum, source/dest)
│   ├── IPv4 addressing (red + host, subredes)
│   ├── NAT (varios privados comparten 1 pública)
│   └── IPv6 (128 bits, sin NAT, encabezado simple)
│
├── 4.4 Generalized Forwarding & SDN
│   ├── Match → campos revisados (IP, puerto, MAC, VLAN)
│   ├── Action → forward, drop, modify, controller
│   └── OpenFlow → tablas de flujo
│
├── 4.5 Middleboxes
│   ├── Firewall
│   ├── NAT
│   ├── Load balancer
│   └── Proxy
│
├── 4.6 Summary
│   └── Recap de forwarding, routing, IPv4/6, NAT, SDN, middleboxes
│
├── Homework Problems
│   └── Ejercicios de formato IP, subredes, NAT, IPv4 vs IPv6
│
└── Wireshark Lab
    ├── Captura de datagramas IPv4
    ├── Observar TTL y campos del header
    └── Ver fragmentación y reensamblado
```



* La capa de red es como la “infraestructura de transporte” de Internet: no garantiza llegar rápido o en orden, solo que *hace el mejor esfuerzo*.
* La transición de IPv4 a IPv6 muestra cómo las limitaciones prácticas (falta de direcciones) llevan a inventar parches (NAT) y después a rediseñar el sistema.
* Los middleboxes solucionan problemas prácticos (seguridad, escalabilidad) pero rompen el principio original de Internet de **“end-to-end”** (los extremos deberían hablar directamente sin que el medio modifique).
* SDN refleja una tendencia en computación: **centralizar el control y simplificar los dispositivos**, parecido a la nube en software.



#  **Posibles preguntas del profe**

###  Preguntas típicas:

1. ¿Cuál es la diferencia entre **forwarding** y **routing**?
2. ¿Qué campos principales tiene un datagrama IPv4?
3. ¿Qué problema resuelve NAT y cómo lo hace?
4. ¿Qué ventajas trae IPv6 frente a IPv4?
5. ¿Qué es un middlebox y da ejemplos?
6. Explica la diferencia entre **data plane** y **control plane**.


### Posibles respuestas:

1. **NAT y end-to-end:** Rompe la comunicación directa, complicando apps P2P como VoIP y juegos online → necesitan protocolos extra (STUN, TURN, ICE).
2. **IPv6 vs IPv4:** No se migra del todo por compatibilidad, costo y porque NAT extendió la vida de IPv4.
3. **Middleboxes con reglas propias:** Generan opacidad, traban innovación y complican diagnóstico.
4. **Un único controlador SDN global:** Escalable en teoría, pero en la práctica sería un punto único de falla y riesgo de seguridad.
5. **Videollamadas en best effort:** Funcionan gracias a protocolos que toleran pérdida, compresión, redundancia y buffers.


##  Preguntas típicas de examen

1. **Forwarding vs Routing:** Forwarding = decisión local en un router (próximo salto). Routing = cálculo global de rutas en la red.
2. **Campos principales IPv4:** versión, longitud del header, TTL, protocolo, checksum, dirección IP origen, dirección IP destino.
3. **Problema que resuelve NAT:** La falta de direcciones IPv4 → permite que muchas privadas compartan una única pública mediante traducción de direcciones y puertos.
4. **Ventajas IPv6:** Espacio de direcciones enorme (128 bits), encabezado más simple, sin necesidad de NAT, soporte para autoconfiguración y seguridad integrada (IPsec).
5. **Middlebox:** Dispositivo que hace más que reenviar paquetes, inspecciona o modifica tráfico. Ejemplos: firewall, proxy, NAT, load balancer.
6. **Data plane vs Control plane:** Data plane = mueve paquetes según reglas (operación local). Control plane = decide las reglas y calcula rutas (lógica central).


###  Preguntas trampa

1. ¿El TTL en IPv4 mide tiempo real en segundos?
    No, mide **número de saltos** (cada router lo decrementa en 1).
2. ¿NAT aumenta el número de direcciones disponibles?
    No, **reutiliza** una pública entre muchos privados, no crea más direcciones.
3. ¿En IPv6 ya no existe la fragmentación?
    En IPv6 los **routers no fragmentan**; si hace falta, lo hace el host origen.
4. ¿Generalized forwarding significa que la red garantiza mejor calidad de servicio?
    No, solo significa que podés tomar decisiones mirando más campos.

## **Ojo..**

**1. Si NAT rompe el principio end-to-end, ¿qué consecuencias trae para aplicaciones como VoIP o juegos online?**

* El **principio end-to-end** dice que los extremos (tu PC ↔ servidor) deberían comunicarse directamente sin que la red intermedie demasiado.
* NAT rompe eso porque cambia direcciones y puertos en el medio.
* Problema: aplicaciones que necesitan conexiones **directas entre clientes** (como VoIP, videollamadas P2P, juegos online) tienen quilombo porque desde afuera no saben cómo llegar a vos si estás detrás de un NAT.
* Soluciones: protocolos como **STUN, TURN, ICE** que intentan “atravesar” el NAT.

 **Ejemplo:** querés llamar a un amigo, pero el portero del edificio (NAT) no sabe a qué depto mandarte si no tenés un truco especial.

 **2. ¿Por qué, si IPv6 existe hace años, seguimos usando tanto IPv4?**

* **Compatibilidad:** muchísimos sistemas, aplicaciones y dispositivos viejos solo entienden IPv4.
* **Costo:** migrar toda una red a IPv6 implica renovar hardware, software y configuración → es caro.
* **Transición:** IPv6 no es retrocompatible con IPv4, entonces hay que mantener ambos (dual-stack), lo cual complica la administración.
* **NAT “alargó la vida” de IPv4:** como se podían compartir direcciones, no hubo tanta urgencia inmediata.

 **Ejemplo:** es como tener que cambiar todas las cerraduras de una ciudad por un nuevo tipo de llave. Si las viejas todavía sirven con un parche (NAT), la gente no se apura a hacer el cambio.

**3. ¿Qué problemas pueden traer los middleboxes si cada proveedor mete sus propias reglas?**

* Pérdida de **transparencia end-to-end**: aplicaciones que esperan que sus mensajes lleguen intactos pueden romperse si un firewall o proxy mete mano.
* **Inconsistencias:** lo que funciona en una red puede no funcionar en otra.
* **Innovación frenada:** nuevas aplicaciones pueden chocar con reglas raras de middleboxes (ejemplo: un firewall que bloquea un protocolo nuevo porque no lo reconoce).
* **Diagnóstico difícil:** cuando algo falla, no sabés si es tu PC, el servidor, o un middlebox de algún ISP en el medio.

 **Ejemplo:** es como mandar cartas y que cada oficina de correo del camino abra el sobre, lo lea y decida si reenviarlo, cambiarlo o tirarlo. Difícil confiar o innovar.

 **4. ¿Qué pasaría si todos los routers del mundo funcionaran con un único controlador SDN central?**

* Ventaja: visión global perfecta de toda la red → podría calcular rutas óptimas y gestionar recursos de forma eficiente.
* Problemas:

  * **Punto único de falla:** si cae el controlador, se cae toda Internet.
  * **Escalabilidad:** manejar miles de millones de dispositivos desde un único lugar sería imposible en tiempo real.
  * **Seguridad:** un hackeo al controlador = control total de Internet.

 **Ejemplo:** es como si toda la red de colectivos del país dependiera de un solo jefe central en una oficina en Buenos Aires. Si se duerme, se corta la luz o alguien lo sabotea → nadie sabe para dónde ir.

 **5. Si Internet funciona con best effort, ¿por qué aún así podemos hacer videollamadas sin que se corte siempre?**

* Aunque la red no **garantiza nada**, hay mecanismos que ayudan:

  * **Redundancia:** muchos caminos posibles → si uno falla, se usa otro.
  * **Velocidades altas y buffers:** la red suele ir lo suficientemente rápido como para que las pérdidas sean mínimas.
  * **Protocolos de aplicación:** videollamadas usan técnicas como **compresión, tolerancia a pérdida, corrección de errores, jitter buffers**.
  * **Diseño de apps:** WhatsApp, Zoom o Meet están preparados para funcionar bien incluso si se pierden algunos paquetes (tu ojo/oreja no lo nota).

 **Ejemplo:** es como hablar por teléfono en un lugar ruidoso: aunque no escuches todas las palabras, entendés la idea porque tu cerebro rellena lo que falta.

---


1. NAT complica apps P2P → necesitan trucos extra.
2. IPv6 no despega por compatibilidad, costo y porque NAT salvó a IPv4.
3. Middleboxes generan opacidad, traban innovación y complican debugging.
4. Un único controlador SDN global sería eficiente pero inseguro y frágil.
5. Videollamadas funcionan bien gracias a protocolos inteligentes que toleran pérdidas y retrasos.

---





# **Cuadro Comparativo – Conceptos clave de la Capa de Red**

| Concepto A                       | Concepto B                 | Diferencia principal                                                                                                         | Ejemplo                                                                                                              |
| -------------------------------- | -------------------------- | ---------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------- |
| **Forwarding**                   | **Routing**                | Forwarding = decisión rápida en un router (próximo salto). Routing = cálculo de rutas a nivel global.                        | Forwarding: el colectivero decide en qué esquina doblar. Routing: la empresa de micros diseña el recorrido de la línea.          |
| **Data Plane**                   | **Control Plane**          | Data plane = mueve paquetes según reglas. Control plane = decide qué reglas usar (algoritmos de routing, políticas).         | Data plane: el chofer maneja el bondi. Control plane: el jefe de tráfico diseña las líneas de colectivos.                        |
| **IPv4**                         | **IPv6**                   | IPv4: 32 bits, \~4.3 mil millones de direcciones, necesita NAT. IPv6: 128 bits, direcciones casi infinitas, no necesita NAT. | IPv4: matrículas de autos con 6 dígitos (se acaban). IPv6: matrículas con letras y números infinitos (no se acaban más).         |
| **NAT**                          | **No NAT (IPv6)**          | NAT permite que muchas IP privadas compartan una sola pública. En IPv6 cada dispositivo tiene su IP única global.            | NAT: un edificio con un solo portero eléctrico (una IP pública). IPv6: cada depto tiene su propio portero eléctrico (IP global). |
| **Router**                       | **Middlebox**              | Router: reenvía paquetes, no los modifica. Middlebox: además inspecciona o altera tráfico (firewall, proxy, NAT).            | Router: boletero que solo corta entrada. Middlebox: seguridad que revisa mochila, te frena o te manda por otro lado.             |
| **Destination-based forwarding** | **Generalized forwarding** | Destination-based = decisión según IP destino. Generalized = decisión con más campos (IP, puerto, protocolo, VLAN).          | Destination: “Si tu casa es en San Telmo, te mando ahí”. Generalized: “Si sos menor, vas por esta puerta; si sos VIP, por otra”. |

---
