#  3.5 Connection-Oriented Transport: TCP

##  ¿Qué es TCP?

* **TCP (Transmission Control Protocol)** es el protocolo de transporte más usado en Internet.
* Provee un servicio **confiable, orientado a conexión** entre dos procesos que se comunican a través de sockets.
* A diferencia de **UDP**, TCP garantiza que los datos lleguen **completos, en orden y sin duplicados**.

Ejemplo:
Cuando abrís una página web (HTTP), mandás un mail (SMTP) o usás FTP, la comunicación usa **TCP** porque necesitás que la información llegue bien.



##  Características principales de TCP

1. **Orientado a conexión**

   * Antes de intercambiar datos, cliente y servidor establecen una conexión lógica (conocido como el **three-way handshake**).
   * Una vez finalizada la comunicación, se cierra la conexión de manera ordenada.

2. **Confiabilidad**

   * Asegura que los datos se entreguen sin errores, en orden y sin duplicados.
   * Implementa los principios de **reliable data transfer (RDT)** vistos en la sección 3.4.

3. **Full-duplex**

   * La comunicación es **bidireccional**: ambos pueden enviar y recibir al mismo tiempo.

4. **Point-to-point**

   * La conexión siempre es entre dos procesos (no multicast ni broadcast en TCP).



##  Establecimiento de Conexión: Three-Way Handshake

1. Cliente manda un **SYN** (solicitud de conexión).
2. Servidor responde con **SYN-ACK** (acepta y confirma).
3. Cliente responde con **ACK** (finaliza el acuerdo).

Recién ahí comienza la transmisión de datos.
Ejemplo: es como cuando llamás a alguien:

* Vos decís “¿Hola, me escuchás?”
* La otra persona responde “Sí, ¿vos me escuchás?”
* Vos contestás “Perfecto” → ahora sí empiezan a hablar.



##  Segmentación y Números de Secuencia

* Los datos que pasan de la aplicación a TCP pueden ser grandes → TCP los divide en **segmentos**.
* Cada byte de datos tiene un **número de secuencia**.
* Esto permite que el receptor pueda:

  * Reconstruir los datos en orden.
  * Detectar pérdidas o duplicados.

Ejemplo: Si un archivo se divide en 5000 bytes, TCP puede mandar segmentos de 1000 bytes cada uno, numerados como 1–1000, 1001–2000, etc.



##  Acknowledgments y Timers

* El receptor envía **ACKs** confirmando qué datos recibió correctamente.
* Si un ACK no llega en cierto tiempo, el emisor retransmite el segmento.
* Esto evita pérdidas.

Ejemplo: Como cuando le contás un número de teléfono a alguien y esperás que te repita para asegurarte que lo anotó bien.



##  Control de Flujo

* TCP regula la cantidad de datos que un emisor puede enviar para no saturar al receptor.
* El receptor informa al emisor cuánto espacio libre tiene en su buffer (**ventana de recepción**).
* Así, el emisor ajusta la velocidad.

Ejemplo: Es como hablar con alguien que escribe lento: le decís las palabras de a poco para que pueda anotarlas sin quedarse atrás.



##  Control de Congestión

* Si hay mucho tráfico en la red, TCP reduce su velocidad de envío para no empeorar la congestión.
* Si la red se libera, TCP vuelve a acelerar.
* Se usa el mecanismo de **ventana deslizante** junto con algoritmos como *slow start* y *congestion avoidance*.

Ejemplo: Es como una autopista: si hay mucho tráfico, manejás más despacio; si está vacía, acelerás.



##  Cierre de Conexión

* TCP cierra la conexión con un intercambio ordenado de mensajes (generalmente **FIN y ACK**).
* Así se asegura que todos los datos enviados hayan sido recibidos.


## Resumen 

Imaginá que TCP es como mandar un paquete importante por un correo premium:

* Antes de empezar, hay un **acuerdo** con la empresa (handshake).
* Cada paquete tiene un **número de seguimiento** (número de secuencia).
* Te avisan con un **recibo** cuando llega (ACK).
* Si el paquete no llega en el tiempo esperado, lo vuelven a enviar (timer + retransmisión).
* El correo regula cuántos paquetes mandar a la vez según la capacidad del destino (control de flujo).
* También ajusta el tráfico si las rutas están saturadas (control de congestión).

---

En conclusión: TCP es el **caballo de batalla de Internet**, ofreciendo una comunicación confiable y ordenada entre aplicaciones. Es más complejo que UDP, pero garantiza que las apps críticas funcionen bien.

---
